<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<style>
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}
* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>
<title>3 Instalação</title>

</head>
<body>
<h1>3 Instalação</h1>

<p>Antes de tentar instalar o Tomcat, é importante ter um ambiente Java instalado de forma correta.</p>

<p>O Tomcat 8 requer um ambiente JRE 7 instalado. Deve-se configurar a variável de ambiente <code>$JAVA_HOME</code> ou <code>$JRE_HOME</code> indicando a localização do ambiente.</p>

<p>Dependendo de como foi instalado, as localizações dos arquivos de configuração, scripts e webapps poderão variar.</p>

<p>A instalação também poderá ser diferente para cada versão. O ideal é verificar o arquivo <code>RUNNING.txt</code> correspondente à versão usada, que faz parte da distribuição e documentação do Tomcat.</p>

<h2>Instalação como aplicação</h2>

<p>Independente de plataforma, o Tomcat pode ser instalado simplesmente baixando o <code>zip</code> ou <code>tar.gz</code> disponível no site, expandindo o arquivo em um diretório que será o <code>$CATALINA_HOME</code>.</p>

<p><code>$CATALINA_HOME</code> deverá ser registrado como variável de ambiente (e <code>$CATALINA_HOME/bin</code> no <code>$PATH</code> caso seja desejado que os scripts executem de qualquer lugar).</p>

<h2>Instalação como serviço</h2>

<p>A instalação como <em>serviço</em> é dependente de plataforma. A instalação como serviço poderá facilitar o uso do servidor, garantindo o reinício automático, e facilidades para interromper, iniciar e reiniciar o serviço.</p>

<p>Instaladores de serviço garantem a instalação das dependências e configuração das variáveis de ambiente, mas a localização dos arquivos poderá ser diferente.</p>

<h3>Serviço Tomcat no Windows</h3>

<p>Para instalar um serviço no Windows deve-se baixar o instalador disponível no site tomcat.apache.org.</p>

<h3>Tomcat 8 no Ubuntu 15</h3>

<p>No Ubuntu 15, o Tomcat 8 pode ser instalado como serviço usando um único comando:</p>

<p><code>$ sudo apto-get install tomcat8</code></p>

<p>A instalação default será em <code>/etc/tomcat8</code>.</p>

<h3>Tomcat 8 no Ubuntu 14</h3>

<p>No Ubuntu 14, o mesmo pode ser feito para instalar o Tomcat 7. para instalar o Tomcat 8, neste caso, é necessário baixar as depedendências, o pacote binário e configurar as permissões.</p>

<p>No exemplo abaixo instala-se o JDK, cria-se um usuário/grupo <code>tomcat/tomcat</code>, baixa-se o pacote Tomcat 8, cria-se a pasta /opt/tomcat e expande-se o pacote nessa pasta:</p>

<pre><code>$ sudo apt-get install default-jdk
$ sudo groupadd tomcat
$ sudo useradd -s /bin/false -g tomcat -d /opt/tomcat tomcat
$ wget http://mirror.nbtelecom.com.br/apache/tomcat/tomcat-8/v8.0.32/bin/apache-tomcat-8.0.32.tar.gz
$ sudo mkdir /opt/tomcat
$ sudo tar xvf apache-tomcat-8*tar.gz -C /opt/tomcat --strip-components=1
</code></pre>

<p>Em seguida deve-se configurar as permissões da pasta recursivamente (para que todo o pacote pertenca ao usuário/grupo <code>tomcat/tomcat</code>).</p>

<h3>Tomcat no Mac OS</h3>

<p>No ambinente deve primeiro estar instalado o pacote <em>HomeBrew</em> (<code>http://brew.sh</code>). O comando abaixo instala a versão mais recente:</p>

<pre><code>$ brew install tomcat
</code></pre>

<h2>Instalação embutida</h2>

<p>A instalação também pode ser realizada através de um ambiente de desenvolvimento (IDE) que criará instância separadas para diferentes aplicações.</p>

<p><strong>[Como instalar e configurar Tomcat no Eclipse]</strong></p>

<h2>Execução</h2>

<p>Para iniciar, finalizar e reiniciar o Tomcat instalado como serviço, é preciso utilizar as ferramentas que diferem em cada plataforma. Em Windows use a aplicação gráfica que é fornecida. Em ambientes Maco OS e Linux, geralmente utiliza-se instruções de linha de comando específicas da plataforma.</p>

<h3>Tomcat instalado como aplicação</h3>

<p>A maior parte da funcionalidade multiplataforma está no script <code>catalina</code> (<code>catalina.bat</code> ou <code>catalina.sh</code>). Outros scripts são atalhos para funções comuns de <code>catalina</code>.</p>

<ul>
<li><code>catalina</code> - contém o código que realiza start, stop e restart</li>
<li><code>startup</code> - roda <code>catalina start</code></li>
<li><code>shutdown</code> - roda <code>catalina stop</code></li>
<li><code>version</code> - roda <code>catalina version</code></li>
<li><code>digest</code> - usado para gerar senhas criptografadas</li>
</ul>


<p>Há também outros scripts que são exclusivos para a plataforma usada.</p>

<p>O script <strong>catalina</strong> também contém outras opções além de <code>version</code>, <code>start</code> e <code>stop</code>.</p>

<ul>
<li><code>run</code> - igual a start, mas não grava logs
embedded - modo embutido, geralmente usado por IDEs</li>
<li><code>debug</code> - modo debug</li>
<li><code>-help</code> lista outros comandos</li>
</ul>


<p>Os comandos também pode ser definidos como propriedades globais da JVM. Neste caso devem ser declarados na variável <code>CATALINA_OPTS</code>.</p>

<p>Os scripts ficam em <code>$CATALINA_HOME/bin</code>. Se este caminho estiver no <code>$PATH</code>, o Tomcat pode ser controlado de qualquer lugar:</p>

<p>Por exemplo, para iniciar:</p>

<ul>
<li><code>startup.bat</code> ou <code>startup.sh</code></li>
<li><code>catalina.bat start</code> ou <code>catalina.sh start</code></li>
</ul>


<p>e para finalizar o serviço:</p>

<ul>
<li><code>shutdown.bat</code> ou <code>shutdown.sh</code></li>
<li><code>catalina.bat stop</code> ou <code>catalina.sh stop</code></li>
</ul>


<p>A instalação básica do Tomcat não oferece serviço de reinício nem de início automático. Para reiniciar é preciso interromper o serviço e depois reiniciar (<code>catalina stop</code>, seguido de <code>catalina start</code>). O shutdown poderá demorar.</p>

<p>Se o Tomcat for instalado como serviço, é possível que o sistema operacionalo oferece a possibilidade de reiniciar o Tomcat.</p>

<h3>Tomcat instalado como serviço</h3>

<p>Se Tomcat foi instalado como um serviço, deve-se usar as opções disponíveis na aplicação que gerencia o serviço para iniciar, reiniciar e interromper o processo. Isto depende do sistema operacional usado. O Windows oferece essa opção através de uma interface gráfica. Em linha de comando e sistemas Unix/Linux geralmente usa-se um script <code>init</code> ou <code>service</code>, por exemplo:</p>

<pre><code>/etc/rc.d/init.d/tomcat start
</code></pre>

<p>ou</p>

<pre><code>service tomcat start
</code></pre>

<p>O nome do serviço poderá ser diferente. Geralmente tem o mesmo nome do serviço instalado (ex: <code>tomcat7</code>, <code>tomcat8</code>, etc.)</p>

<p>É possível usar ferramentas do sistema operacional para garantir o reinício automático e início ao login do Tomcat mais facilmente se ele estiver instalado como serviço.</p>

<h2>Variáveis de ambiente importantes</h2>

<p>Na inicialização, o log por default começa imprimindo as variáveis de ambiente. Se o Tomcat for iniciado como aplicação, o log por default é impresso na tela do console. Verifique as variáveis usadas na inicialização.</p>

<pre><code>$ catalina.sh start
Using CATALINA_BASE: /home/helderdarocha/apache-tomcat-8.0.32
Using CATALINA_HOME: /home/helderdarocha/apache-tomcat-8.0.32
Using CATALINA_TMPDIR: /home/helderdarocha/apache-tomcat-8.0.32/temp
Using JRE_HOME: /usr/java/jdk1.8.0_01
</code></pre>

<p>Erros ou falha na inicialização poderão ocorrer com <code>JAVA_HOME</code> ou <code>JRE_HOME</code> definidas incorretamente.</p>

<h2>Teste da instalação</h2>

<p>Inicie o serviço rodando os scripts em <code>$CATALINA_HOME/bin</code> ou usando ferramenta de administração do serviço Tomcat.</p>

<p>Acesse o site <code>localhost:8080</code>.</p>

<h2>Erros de instalação comuns</h2>

<p>Os principais erros de instalação tem a ver com instâncias rodando previamente e conflito de portas. A porta default do Tomcat é 8080, que é uma porta frequentemente usada por default por vários serviços simples que criam servidores Web. Verifique se sua plataforma já não contém outro serviço rodando nessa porta usando as ferramentas específicas do seu sistema operacional (ex: <code>grep</code>, <code>netstat</code>). Se você estiver usando algum IDE que roda o Tomcat, ele também pode estar usando a porta, causando conflito.</p>

<p>As portas usadas pelo Tomcat podem ser alteradas com facilidade na configuração.</p>

<p>O <strong>shutdown</strong> do Tomcat não é garantido, e pode demorar. Um servlet pode ter criado um thread com prioridade mais alta, que impede o shutdown, pode ter havido um estouro de memória (que impede o acesso à porta de shutdown).</p>

<p>Se o processo Java do Tomcat não tiver terminado, a porta pode ainda estar sendo bloqueada e será necessário forçar o seu fim usando ferramentas do seu sistema operacional (kill, etc.) ou mesmo, em casos extremos, reiniciar o sistema.</p>
</body>
</html>